<div class="container">
  @defer (when userCollection !== null) {
    <h1>
      Tous les clients et propriétaires <small>({{ userCollection?.total }})</small>
    </h1>

    <div class="admin-table">
      <table>
        @if (userCollection?.total === 0) {
            <caption>Aucun utilisateur avec le rôle client ou propriétaire</caption>
        }

        <thead>
        <tr>
          <th>ID</th>
          <th>Avatar</th>
          <th>Adresse mail</th>
          <td>Téléphone</td>
          <th>Nom complet</th>
          <th>Rôles</th>
          <th>Actions</th>
        </tr>
        </thead>

        <tbody>
          @for (user of userCollection?.users; track user.id) {
            <tr>
              <td>{{ user.id }}</td>

              <td class="admin-avatar">
                @if (user.photo) {
                  <ui-avatar [avatar]="user.photo" width="32" height="32"></ui-avatar>
                } @else {
                  <ui-avatar avatar="/img/default-avatar.png" width="32" height="32"></ui-avatar>
                }
              </td>

              <td>{{ user.email }}</td>

              <td>{{ user.telephone }}</td>

              <td>{{ user.prenom }} {{ user.nom }}</td>

              <td class="admin-roles">
                @for (role of user.roles | roles; track role) {
                  <ui-user-badge [role]="role"></ui-user-badge>
                }
              </td>

              <td class="admin-actions">
                <div>
                  <button [routerLink]="`/admin/users/edit/${user.id}`" class="btn btn--ultra-small btn--info" title="Éditer">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M7 7H6C5.46957 7 4.96086 7.21071 4.58579 7.58579C4.21071 7.96086 4 8.46957 4 9V18C4 18.5304 4.21071 19.0391 4.58579 19.4142C4.96086 19.7893 5.46957 20 6 20H15C15.5304 20 16.0391 19.7893 16.4142 19.4142C16.7893 19.0391 17 18.5304 17 18V17"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <path
                        d="M16 4.99998L19 7.99998M20.385 6.58499C20.7788 6.19114 21.0001 5.65697 21.0001 5.09998C21.0001 4.543 20.7788 4.00883 20.385 3.61498C19.9912 3.22114 19.457 2.99988 18.9 2.99988C18.343 2.99988 17.8088 3.22114 17.415 3.61498L9 12V15H12L20.385 6.58499Z"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </button>

                  <button (click)="onDelete(user)" class="btn btn--ultra-small btn--danger" title="Supprimer">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M7.37784 5.531C7.89147 5.0302 8.58047 4.74994 9.29784 4.75H19.5948C20.1928 4.75 20.8888 4.916 21.4578 5.269C22.0368 5.627 22.5678 6.243 22.5678 7.125V16.875C22.5678 17.757 22.0368 18.372 21.4578 18.731C20.8948 19.0684 20.2512 19.2477 19.5948 19.25H9.29784C8.58047 19.2501 7.89147 18.9698 7.37784 18.469L2.02784 13.253C1.86062 13.09 1.72773 12.8951 1.63699 12.6799C1.54626 12.4647 1.49951 12.2335 1.49951 12C1.49951 11.7665 1.54626 11.5353 1.63699 11.3201C1.72773 11.1049 1.86062 10.91 2.02784 10.747L7.37784 5.531ZM14.0298 9.47C13.9612 9.39631 13.8784 9.33721 13.7864 9.29622C13.6944 9.25523 13.5951 9.23318 13.4944 9.23141C13.3937 9.22963 13.2936 9.24816 13.2002 9.28588C13.1069 9.3236 13.022 9.37974 12.9508 9.45096C12.8796 9.52218 12.8234 9.60701 12.7857 9.7004C12.748 9.79379 12.7295 9.89382 12.7312 9.99452C12.733 10.0952 12.7551 10.1945 12.7961 10.2865C12.837 10.3785 12.8961 10.4613 12.9698 10.53L14.4398 12L12.9698 13.47C12.8961 13.5387 12.837 13.6215 12.7961 13.7135C12.7551 13.8055 12.733 13.9048 12.7312 14.0055C12.7295 14.1062 12.748 14.2062 12.7857 14.2996C12.8234 14.393 12.8796 14.4778 12.9508 14.549C13.022 14.6203 13.1069 14.6764 13.2002 14.7141C13.2936 14.7518 13.3937 14.7704 13.4944 14.7686C13.5951 14.7668 13.6944 14.7448 13.7864 14.7038C13.8784 14.6628 13.9612 14.6037 14.0298 14.53L15.4998 13.06L16.9698 14.53C17.0385 14.6037 17.1213 14.6628 17.2133 14.7038C17.3053 14.7448 17.4046 14.7668 17.5053 14.7686C17.606 14.7704 17.706 14.7518 17.7994 14.7141C17.8928 14.6764 17.9777 14.6203 18.0489 14.549C18.1201 14.4778 18.1762 14.393 18.214 14.2996C18.2517 14.2062 18.2702 14.1062 18.2684 14.0055C18.2667 13.9048 18.2446 13.8055 18.2036 13.7135C18.1626 13.6215 18.1035 13.5387 18.0298 13.47L16.5598 12L18.0298 10.53C18.1035 10.4613 18.1626 10.3785 18.2036 10.2865C18.2446 10.1945 18.2667 10.0952 18.2684 9.99452C18.2702 9.89382 18.2517 9.79379 18.214 9.7004C18.1762 9.60701 18.1201 9.52218 18.0489 9.45096C17.9777 9.37974 17.8928 9.3236 17.7994 9.28588C17.706 9.24816 17.606 9.22963 17.5053 9.23141C17.4046 9.23318 17.3053 9.25523 17.2133 9.29622C17.1213 9.33721 17.0385 9.39631 16.9698 9.47L15.4998 10.94L14.0298 9.47Z"
                        fill="currentColor"/>
                    </svg>
                  </button>
                </div>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  } @placeholder {
    <ui-loader></ui-loader>
  }
</div>
