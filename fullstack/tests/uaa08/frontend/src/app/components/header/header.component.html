<header class="topbar lg:container">
  <button class="topbar:sm:menu-burger" (click)="toggleMenu()">
    <span class="topbar-menu-burger--line"></span>
    <span class="topbar-menu-burger--line"></span>
    <span class="topbar-menu-burger--line"></span>
    <span hidden>Menu</span>
  </button>

  <div class="topbar-logo">
    <a routerLink="/" class="topbar-logo-link">ImmauWeb</a>
  </div>

  <nav class="topbar-navbar no-mobile">
    <ul class="topbar-navbar-list">
      <li class="topbar-navbar-item topbar-navbar-item--annonce">
        @if (currentUser) {
          <a routerLink="/annonce/new" class="topbar-navbar-item-link topbar-navbar-item--annonce-link">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M4 9H9V4H15V9H20V15H15V20H9V15H4V9ZM11 13V18H13V13H18V11H13V6H11V11H6V13H11Z"
                fill="currentColor"
              />
            </svg>
          </a>

          <span>&brvbar;</span>
        }

        <a routerLink="/annonces" class="topbar-navbar-item-link">Annonces</a>
      </li>

      @if (isAdmin) {
        <li class="topbar-navbar-item">
          <a routerLink="/admin" class="topbar-navbar-item-link">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12 1L3 5V11C3 16.55 6.84 21.74 12 23C17.16 21.74 21 16.55 21 11V5L12 1ZM12 4.9C12.5933 4.9 13.1734 5.07595 13.6667 5.40559C14.1601 5.73524 14.5446 6.20377 14.7716 6.75195C14.9987 7.30013 15.0581 7.90333 14.9424 8.48527C14.8266 9.06721 14.5409 9.60176 14.1213 10.0213C13.7018 10.4409 13.1672 10.7266 12.5853 10.8424C12.0033 10.9581 11.4001 10.8987 10.8519 10.6716C10.3038 10.4446 9.83524 10.0601 9.50559 9.56671C9.17595 9.07336 9 8.49334 9 7.9C9 7.10435 9.31607 6.34129 9.87868 5.77868C10.4413 5.21607 11.2044 4.9 12 4.9ZM12 12.8C14 12.8 18 13.89 18 15.88C17.3432 16.8701 16.4516 17.6823 15.4047 18.2442C14.3578 18.806 13.1881 19.1 12 19.1C10.8119 19.1 9.64218 18.806 8.59527 18.2442C7.54836 17.6823 6.65677 16.8701 6 15.88C6 13.89 10 12.8 12 12.8Z"
                fill="currentColor"
              />
            </svg>

            Administration
          </a>
        </li>
      }
    </ul>
  </nav>

  <nav class="topbar-navbar">
    <ul class="topbar-navbar-list">
      @if (!isAdmin) {
        <li class="topbar-navbar-item no-mobile">
          <a routerLink="/contact-us" class="topbar-navbar-item-link">
            Nous contacter
          </a>
        </li>
      }
      @if (currentUser) {
        <li class="topbar-navbar-item topbar-navbar-item--user">
          <button class="topbar-navbar-item--user-btn" type="button" popovertarget="user-menu">
            <figure class="topbar-avatar">
              @if (currentUser.photo) {
                <img
                  [ngSrc]="currentUser.photo"
                  alt="Photo utilisateur"
                  width="64"
                  height="64"
                  priority="priority"
                />
              } @else {
                <strong class="mobile-only">
                  {{ `${currentUser.prenom} ${currentUser.nom}` | initials }}
                </strong>
              }

              <figcaption class="topbar-avatar-name no-mobile">
                <strong>{{ currentUser.prenom }} {{ currentUser.nom }}</strong>
                <span>{{ currentUser.email }}</span>
              </figcaption>
            </figure>
          </button>

          <menu class="menu:user-menu" type="context" id="user-menu" popover>
            <div class="menu:user-menu:personal-info">
              <strong>{{ currentUser.prenom }} {{ currentUser.nom }}</strong>
              <em>{{ currentUser.email }}</em>
            </div>

            <li class="menu:user-menu:item">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12 4C13.0609 4 14.0783 4.42143 14.8284 5.17157C15.5786 5.92172 16 6.93913 16 8C16 9.06087 15.5786 10.0783 14.8284 10.8284C14.0783 11.5786 13.0609 12 12 12C10.9391 12 9.92172 11.5786 9.17157 10.8284C8.42143 10.0783 8 9.06087 8 8C8 6.93913 8.42143 5.92172 9.17157 5.17157C9.92172 4.42143 10.9391 4 12 4ZM12 14C16.42 14 20 15.79 20 18V20H4V18C4 15.79 7.58 14 12 14Z"
                  fill="currentColor"
                />
              </svg>

              <a routerLink="/account" class="menu:user-menu:link">
                Mon compte
              </a>
            </li>

            @if (isAdmin) {
              <li class="menu:user-menu:item">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M12 1L3 5V11C3 16.55 6.84 21.74 12 23C17.16 21.74 21 16.55 21 11V5L12 1ZM12 4.9C12.5933 4.9 13.1734 5.07595 13.6667 5.40559C14.1601 5.73524 14.5446 6.20377 14.7716 6.75195C14.9987 7.30013 15.0581 7.90333 14.9424 8.48527C14.8266 9.06721 14.5409 9.60176 14.1213 10.0213C13.7018 10.4409 13.1672 10.7266 12.5853 10.8424C12.0033 10.9581 11.4001 10.8987 10.8519 10.6716C10.3038 10.4446 9.83524 10.0601 9.50559 9.56671C9.17595 9.07336 9 8.49334 9 7.9C9 7.10435 9.31607 6.34129 9.87868 5.77868C10.4413 5.21607 11.2044 4.9 12 4.9ZM12 12.8C14 12.8 18 13.89 18 15.88C17.3432 16.8701 16.4516 17.6823 15.4047 18.2442C14.3578 18.806 13.1881 19.1 12 19.1C10.8119 19.1 9.64218 18.806 8.59527 18.2442C7.54836 17.6823 6.65677 16.8701 6 15.88C6 13.89 10 12.8 12 12.8Z"
                    fill="currentColor"
                  />
                </svg>

                <a routerLink="/admin" class="menu:user-menu:link">
                  Administration
                </a>
              </li>
            }

            <li class="menu:user-menu:item menu:user-menu:item--logout">
              <svg
                width="16"
                height="16"
                viewBox="0 0 16 16"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M13.5626 11.4375H12.4642C12.3892 11.4375 12.3189 11.4703 12.272 11.5281C12.1626 11.661 12.0454 11.7891 11.922 11.911C11.4171 12.4163 10.8191 12.8191 10.161 13.0969C9.47925 13.3849 8.74646 13.5326 8.00635 13.5313C7.25792 13.5313 6.53292 13.3844 5.85167 13.0969C5.19358 12.8191 4.59557 12.4163 4.09073 11.911C3.58498 11.4073 3.1817 10.8103 2.90323 10.1531C2.61417 9.4719 2.46885 8.74846 2.46885 8.00002C2.46885 7.25159 2.61573 6.52815 2.90323 5.8469C3.18135 5.18909 3.58135 4.5969 4.09073 4.08909C4.6001 3.58127 5.19229 3.18127 5.85167 2.90315C6.53292 2.61565 7.25792 2.46877 8.00635 2.46877C8.75479 2.46877 9.47979 2.61409 10.161 2.90315C10.8204 3.18127 11.4126 3.58127 11.922 4.08909C12.0454 4.21252 12.161 4.34065 12.272 4.4719C12.3189 4.52971 12.3907 4.56252 12.4642 4.56252H13.5626C13.661 4.56252 13.722 4.45315 13.6673 4.37034C12.4689 2.50784 10.372 1.27502 7.98917 1.28127C4.24542 1.29065 1.24385 4.32971 1.28135 8.06877C1.31885 11.7485 4.31573 14.7188 8.00635 14.7188C10.3829 14.7188 12.4704 13.4875 13.6673 11.6297C13.7204 11.5469 13.661 11.4375 13.5626 11.4375ZM14.9517 7.90159L12.7345 6.15159C12.6517 6.08596 12.5314 6.14534 12.5314 6.25002V7.43752H7.6251C7.55635 7.43752 7.5001 7.49377 7.5001 7.56252V8.43752C7.5001 8.50627 7.55635 8.56252 7.6251 8.56252H12.5314V9.75002C12.5314 9.85471 12.6532 9.91409 12.7345 9.84846L14.9517 8.09846C14.9666 8.08677 14.9787 8.07183 14.987 8.05477C14.9953 8.03772 14.9996 8.019 14.9996 8.00002C14.9996 7.98105 14.9953 7.96233 14.987 7.94527C14.9787 7.92822 14.9666 7.91328 14.9517 7.90159Z"
                  fill="currentColor"
                />
              </svg>

              <button type="button" (click)="logout()">
                Me déconnecter
              </button>
            </li>
          </menu>
        </li>
      } @else {
        <li class="topbar-navbar-item">
          <a routerLink="/login" class="topbar-navbar-item-link">
            Se connecter
          </a>
        </li>
      }
    </ul>
  </nav>
</header>

<div class="off-canvas mobile-only" [ngClass]="{ 'on-canvas': offcanvas }">
  <aside class="off-canvas-aside">
    <nav class="off-canvas-navbar page-center">
      <ul class="off-canvas-navbar-list">
        <li class="topbar-navbar-item--annonce">
          @if (currentUser) {
            <a routerLink="/annonce/new" class="topbar-navbar-item--annonce-link">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M4 9H9V4H15V9H20V15H15V20H9V15H4V9ZM11 13V18H13V13H18V11H13V6H11V11H6V13H11Z"
                  fill="currentColor"
                />
              </svg>
            </a>

            <span>&brvbar;</span>
          }

          <a routerLink="/annonces" class="topbar-navbar-item-link">Annonces</a>
        </li>

        @if (isAdmin) {
          <li>
            <a routerLink="/admin" class="topbar-navbar-item-link">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12 1L3 5V11C3 16.55 6.84 21.74 12 23C17.16 21.74 21 16.55 21 11V5L12 1ZM12 4.9C12.5933 4.9 13.1734 5.07595 13.6667 5.40559C14.1601 5.73524 14.5446 6.20377 14.7716 6.75195C14.9987 7.30013 15.0581 7.90333 14.9424 8.48527C14.8266 9.06721 14.5409 9.60176 14.1213 10.0213C13.7018 10.4409 13.1672 10.7266 12.5853 10.8424C12.0033 10.9581 11.4001 10.8987 10.8519 10.6716C10.3038 10.4446 9.83524 10.0601 9.50559 9.56671C9.17595 9.07336 9 8.49334 9 7.9C9 7.10435 9.31607 6.34129 9.87868 5.77868C10.4413 5.21607 11.2044 4.9 12 4.9ZM12 12.8C14 12.8 18 13.89 18 15.88C17.3432 16.8701 16.4516 17.6823 15.4047 18.2442C14.3578 18.806 13.1881 19.1 12 19.1C10.8119 19.1 9.64218 18.806 8.59527 18.2442C7.54836 17.6823 6.65677 16.8701 6 15.88C6 13.89 10 12.8 12 12.8Z"
                  fill="currentColor"
                />
              </svg>

              Administration
            </a>
          </li>
        }
      </ul>

      <ul class="off-canvas-navbar-list">
        @if (!isAdmin) {
          <li>
            <a routerLink="/contact-us" class="topbar-navbar-item-link">Nous contacter</a>
          </li>
        }
        @if (!currentUser) {
          <li>
            <a routerLink="/login" class="topbar-navbar-item-link">Se connecter</a>
          </li>
        } @else {
          <li>
            <a routerLink="/account" class="topbar-navbar-item-link">Mon compte</a>
          </li>

          <li>
            <button (click)="logout()" class="topbar-navbar-item-link btn link">Me déconnecter</button>
          </li>
        }
      </ul>
    </nav>
  </aside>
</div>
