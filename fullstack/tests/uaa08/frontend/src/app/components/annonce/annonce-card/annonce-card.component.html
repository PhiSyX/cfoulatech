<article
  class="annonce-card"
  [ngStyle]="{
    '--annonce-card-url': annonce.propriete.photoPrincipale?.chemin ? `url(${annonce.propriete.photoPrincipale?.chemin})`: undefined,
  }"
>
  <header class="annonce-card-types">
    <span class="annonce-card-types-item">
      {{ annonce.propriete.type | titlecase }}
    </span>

    <span class="annonce-card-types-item">
      {{ annonce.type | titlecase }}
    </span>
  </header>

  <div class="annonce-card-body">
    <h3 class="annonce-card-title">
      <span>{{ annonce.propriete.titre }}</span>

      @if (delete) {
        <button type="button" class="annonce-card-btn" (click)="handleDelete()">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M7 21C6.45 21 5.97933 20.8043 5.588 20.413C5.19667 20.0217 5.00067 19.5507 5 19V6H4V4H9V3H15V4H20V6H19V19C19 19.55 18.8043 20.021 18.413 20.413C18.0217 20.805 17.5507 21.0007 17 21H7ZM9 17H11V8H9V17ZM13 17H15V8H13V17Z"
              fill="currentColor"
            />
          </svg>
        </button>
      }

      @if (favorite) {
        <button type="button" class="annonce-card-btn" (click)="toggleFavorite()">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M8.85009 16.825L12.0001 14.925L15.1501 16.85L14.3251 13.25L17.1001 10.85L13.4501 10.525L12.0001 7.12495L10.5501 10.5L6.90008 10.825L9.67509 13.25L8.85009 16.825ZM12.0001 17.275L7.85008 19.775C7.66675 19.8916 7.47508 19.9416 7.27508 19.9249C7.07508 19.9083 6.90008 19.8416 6.75008 19.725C6.60008 19.6083 6.48342 19.4626 6.40008 19.288C6.31675 19.1133 6.30008 18.9173 6.35008 18.7L7.45008 13.975L3.77508 10.8C3.60842 10.65 3.50442 10.479 3.46308 10.287C3.42175 10.095 3.43408 9.90762 3.50008 9.72495C3.56608 9.54228 3.66608 9.39228 3.80008 9.27495C3.93408 9.15762 4.11742 9.08262 4.35008 9.04995L9.20008 8.62495L11.0751 4.17495C11.1584 3.97495 11.2878 3.82495 11.4631 3.72495C11.6384 3.62495 11.8174 3.57495 12.0001 3.57495C12.1828 3.57495 12.3618 3.62495 12.5371 3.72495C12.7124 3.82495 12.8418 3.97495 12.9251 4.17495L14.8001 8.62495L19.6501 9.04995C19.8834 9.08328 20.0668 9.15828 20.2001 9.27495C20.3334 9.39162 20.4334 9.54162 20.5001 9.72495C20.5668 9.90829 20.5794 10.096 20.5381 10.288C20.4967 10.48 20.3924 10.6506 20.2251 10.8L16.5501 13.975L17.6501 18.7C17.7001 18.9166 17.6834 19.1126 17.6001 19.288C17.5168 19.4633 17.4001 19.609 17.2501 19.725C17.1001 19.841 16.9251 19.9076 16.7251 19.9249C16.5251 19.9423 16.3334 19.8923 16.1501 19.775L12.0001 17.275Z"
              [attr.fill]="isinFavs ? 'var(--color-yellow)' : 'currentColor'"
              [attr.stroke]="isinFavs ? 'var(--color-yellow)' : 'transparent'"
            />
          </svg>
        </button>
      }
    </h3>

    <p class="annonce-card-message">
      {{ annonce.message | truncate:150 }}
    </p>

    <p class="annonce-card-message annonce-card-address">
      {{ annonce.propriete.adresse.codePostal }}
      {{ annonce.propriete.adresse.ville }},
      {{ annonce.propriete.adresse.pays }}
    </p>

    <footer class="annonce-card-footer">
      <strong>{{ annonce.propriete.prix | price }}</strong>
      <em class="annonce-card-date">
        Annonce créée le {{ annonce.createdAt | date:'d MMMM Y' }}
      </em>
    </footer>
  </div>

  @if (updateLink) {
    <a [routerLink]="`/annonce/edit/${annonce.id}`" [state]="{ annonce: annonce }" class="annonce-card-full-link">
      Modifier l'annonce
    </a>
  } @else {
    <a [routerLink]="`/annonce/${annonce.id}`" class="annonce-card-full-link">Visualiser l'annonce</a>
  }
</article>
